<Project Sdk="Microsoft.NET.Sdk.Web">

	<PropertyGroup>
		<TargetFramework>net6.0</TargetFramework>
		<Nullable>enable</Nullable>
		<ImplicitUsings>disable</ImplicitUsings>
		<RootNamespace>Replacement.WebApp</RootNamespace>
		<UserSecretsId>48e49a0b-31db-4fd6-b23b-5f3582f721ef</UserSecretsId>
	</PropertyGroup>

	<ItemGroup>
		<PackageReference Include="Brimborium.Registrator" Version="1.1.79-g858c964373" />
		<PackageReference Include="Microsoft.AspNetCore.Authentication.Negotiate" Version="6.0.4" />
		<PackageReference Include="Microsoft.Orleans.CodeGenerator.MSBuild" Version="3.6.1">
			<PrivateAssets>all</PrivateAssets>
			<IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
		</PackageReference>
		<PackageReference Include="Microsoft.Orleans.Persistence.AdoNet" Version="3.6.1" />
		<PackageReference Include="Microsoft.Orleans.Server" Version="3.6.1" />

		<PackageReference Include="Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation" Version="5.0.15" />
		<PackageReference Include="Microsoft.AspNetCore.OData" Version="8.0.8" />
		<PackageReference Include="Newtonsoft.Json" Version="13.0.1" />
		<PackageReference Include="Swashbuckle.AspNetCore" Version="6.3.0" />
		<PackageReference Include="Swashbuckle.AspNetCore.Annotations" Version="6.3.0" />
		<PackageReference Include="Swashbuckle.AspNetCore.Swagger" Version="6.3.0" />
		<PackageReference Include="Swashbuckle.AspNetCore.SwaggerGen" Version="6.3.0" />
	</ItemGroup>

  <!--
  
		<PackageReference Include="System.DirectoryServices" Version="6.0.0" />
		<PackageReference Include="System.DirectoryServices.AccountManagement" Version="6.0.0" />
		<PackageReference Include="System.DirectoryServices.Protocols" Version="6.0.1" />
  
  -->

	<ItemGroup>
	  <ProjectReference Include="..\Replacement.Contracts\Replacement.Contracts.csproj" />
	  <ProjectReference Include="..\Replacement.Repository\Replacement.Repository.csproj" />
	</ItemGroup>

	<ItemGroup>
	  <Orleans_CodeGenInputs Remove="Controllers\ReplacementControllerBase.cs" />
	</ItemGroup>

	<Target Name="SwaggerGenerate">
		<PropertyGroup>
			<SwaggerOutputPath>$(MSBuildProjectDirectory)\..\Replacement.Client\openapi.json</SwaggerOutputPath>
			<SwaggerCommand>dotnet run -- --Swagger:Generate=true --Swagger:OutputPath="$(SwaggerOutputPath)"</SwaggerCommand>
			<ClientProjectPath>$(MSBuildProjectDirectory)\..\Replacement.Client\Replacement.Client.csproj</ClientProjectPath>
		</PropertyGroup>
		<Message Text="$(ProjectPriFileName)" Importance="high" />
		<Exec Command="$(SwaggerCommand)" ContinueOnError="true"></Exec>
		<MSBuild Projects="$(ClientProjectPath)" Targets="SwaggerGenerate" Properties="Configuration=$(Configuration)" />
	</Target>
</Project>
